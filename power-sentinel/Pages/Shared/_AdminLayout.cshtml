@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<!doctype html>
<html class="h-full bg-gray-100">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - PowerSentinel</title>
    <link rel="icon" href="favicon.ico">
    <script>
        (function () {
            try {
                const stored = localStorage.getItem('ps-theme');
                if (stored === 'dark') document.documentElement.classList.add('dark');
                else if (stored === 'light') { document.documentElement.classList.remove('dark'); document.documentElement.classList.add('light'); }
            } catch (e) { }
        })();
    </script>
    <link rel="stylesheet" href="/css/site.css" />
</head>

<body class="min-h-full bg-gray-100 dark:bg-gray-900">
    <header class="bg-slate-800 text-white">
        <div class="mx-auto max-w-7xl px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-6">
                <a asp-page="/Index" class="hover:underline">
                    <h1 class="text-lg font-semibold">Power-Sentinel</h1>
                </a>
                <a asp-page="/Admin/Index" class="hover:underline">
                    <h1 class="text-lg font-semibold">Admin</h1>
                </a>
                @{
                    var path = Context.Request.Path.Value ?? string.Empty;
                }
                <nav class="space-x-4 text-sm">
                    <a asp-page="/Admin/Devices/Index"
                       class="@(path.StartsWith("/Admin/Devices", StringComparison.OrdinalIgnoreCase) ? "text-white underline font-semibold" : "hover:underline text-slate-200")">Devices</a>
                    <a asp-page="/Admin/Events/Index"
                       class="@(path.StartsWith("/Admin/Events", StringComparison.OrdinalIgnoreCase) ? "text-white underline font-semibold" : "hover:underline text-slate-200")">Events</a>
                    <a asp-page="/Admin/Subscribers/Index"
                       class="@(path.StartsWith("/Admin/Subscribers", StringComparison.OrdinalIgnoreCase) ? "text-white underline font-semibold" : "hover:underline text-slate-200")">Subscribers</a>
                </nav>
            </div>
            <div class="text-sm flex items-center gap-2">
                <button id="theme-toggle" aria-label="Toggle color theme" aria-pressed="false"
                        class="text-sm dark:border-gray-700 border border-gray-200 rounded px-2 py-1 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="sun-icon w-4 h-4 block dark:hidden"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-6.364-1.414 1.414M7.05 16.95l-1.414 1.414M16.95 16.95l1.414 1.414M6.343 6.343L4.929 4.929M12 8a4 4 0 100 8 4 4 0 000-8z" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="moon-icon w-4 h-4 hidden dark:block"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
                    </svg>
                </button>
                <a asp-page="/Admin/Logout" class="hover:underline">Logout</a>
            </div>
        </div>
    </header>
    <main>
        <div class="mx-auto max-w-7xl p-2">
            <div class="bg-white dark:bg-slate-900 shadow rounded-lg p-2 dark:text-gray-100">
                @RenderBody()
            </div>
        </div>
    </main>
    <script>
        (function () {
            const storageKey = 'ps-theme';
            const toggle = document.getElementById('theme-toggle');
            const apply = (theme) => {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    document.documentElement.classList.remove('light');
                } else {
                    document.documentElement.classList.remove('dark');
                    document.documentElement.classList.add('light');
                }
            };

            const stored = localStorage.getItem(storageKey);
            if (stored) apply(stored);
            else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) apply('dark');

            toggle?.addEventListener('click', () => {
                const isNowDark = document.documentElement.classList.toggle('dark');
                if (isNowDark) {
                    document.documentElement.classList.remove('light');
                    localStorage.setItem(storageKey, 'dark');
                } else {
                    document.documentElement.classList.add('light');
                    localStorage.setItem(storageKey, 'light');
                }
            });
        })();
    </script>
</body>

</html>